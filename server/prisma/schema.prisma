// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator dbml {
  provider = "prisma-dbml-generator"
  output     = "../src/docs/diagram-dbml"
  outputName = "recipe.dbml"
}

generator custom_generator {
  provider = "prisma-generator-fake-data"
  output   = "../src/mocks/random-mock.ts"
}

model User {
  id               String         @id @default(uuid())
  name             String
  email            String         @unique
  password         String
  followers        User[]         @relation(name: "Followers")
  follows          User[]         @relation(name: "Followers")
  recipes          Recipe[]       @relation("RecipeOwner")
  favorites        Recipe[]       @relation("Favorite")
  notifications    Notification[]
  messagesSent     Message[]      @relation("Sent")
  messagesReceived Message[]      @relation("Received")
}

model Recipe {
  id                  String @id @default(uuid())
  ownerId             String
  tagId               String
  name                String
  description         String
  ingredients         String
  image               String
  rating              Float
  methodOfPreparation String
  kcal                Int
  owner               User   @relation("RecipeOwner", fields: [ownerId], references: [id])
  favoritesBy         User[] @relation("Favorite")
  tag                 Tag    @relation(fields: [tagId], references: [id])
}

model Tag {
  id      String   @id @default(uuid())
  name    String
  image   String
  recipes Recipe[]
}

model Notification {
  id          String @id @default(uuid())
  image       String
  name        String
  description String
  forUsers    User[]
}

model Message {
  id         String @id @default(uuid())
  senderId   String
  receiverId String
  text       String
  created    Int
  receiver   User   @relation("Received", fields: [receiverId], references: [id])
  sender     User   @relation("Sent", fields: [senderId], references: [id])
}
